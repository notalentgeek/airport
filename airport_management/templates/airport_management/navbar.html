{% load static %}

<nav class="navbar navbar-default">

  <!-- Header and burger button for mobile view. -->
  <div class="navbar-header">
    <a class="navbar-brand" href="#" id="title">airport management</a>
    <button aria-expanded="false" class="collapsed navbar-toggle"
      data-target="#main-menu" data-toggle="collapse" type="button">
      <span class="sr-only">toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
  </div>

  <!-- Main menu, mainly used for login, logout, and register. -->
  <div class="collapse navbar-collapse" id="main-menu">
    <div class="navbar-left">
      <ul class="nav navbar-nav" id="move-atc-menu-here-when-mobile">

        <li class="dropdown" id="hide-atc-menu-when-mobile">
          <a aria-expanded="false" aria-haspopup="true" class="dropdown-toggle"
            data-toggle="dropdown" href="#" role="button">
            atc<span class="caret"></span>
          </a>
          <ul class="dropdown-menu" id="move-atc-menu-here-when-not-mobile">
            <li id="atc-form-button-container">
              <a href="#" id="atc-form-button">atc form</a>
            </li>
            <li id="atc-list-button-container">
              <a href="#" id="atc-list-button">atcs list</a>
            </li>
          </ul>
        </li>

      </ul>
    </div>

    <div class="navbar-right">

      {% if user.is_authenticated and not user.is_superuser %}
        <form action="{% url 'airport_management:logout_airport_manager' %}"
          class="navbar-form" id="logout-form" method="POST">
          {% csrf_token %}
          <div id="logout-form-button-container">
            <input class="btn btn-block btn-success" id="user-button"
              param="{{ user.username }}" type="submit"
              value="hello! {{ user.username }}" />
          </div>
        </form>
      {% else %}
        <form action="{% url 'airport_management:login_or_register_airport_manager' %}"
          class="navbar-form" id="login-register-form" method="POST"
          ng-controller="login_register_form">
          <div id="main-menu-container">
            {% csrf_token %}

            <!-- Form's text input. -->
            <div id="main-menu-form-input">
              <input class="form-control" id="username-input" type="text"
                name="username" param="{% url 'airport_management:check_user_existence' %}"
                placeholder="user name" ng-change="check_user_existence()"
                ng-model="username_input" />

              <!--
              Adding wrong password modal trigger with these codes. The
              template received error message from the Django server. The
              difference between the `if` and `else` is the attribute
              `param="{{ wrong_password }}"` which later triggered in nav.js.
              -->
              {% if messages %}
                {% for message in messages %}
                  {% with wrong_password=message %}
                    <input class="form-control" id="password-input"
                      type="password" name="password"
                      param="{{ wrong_password }}" placeholder="password" />
                  {% endwith %}
                {% endfor %}
              {% else %}
                <input class="form-control" id="password-input"
                  type="password" name="password" placeholder="password" />
              {% endif %}
            </div>

            <!-- Form's buttons. -->
            <div id="main-menu-form-buttons-container">
              <div class="main-menu-form-button">
                <input class="btn btn-block btn-success" name="submit-button"
                  type="submit" value="login" />
              </div>
              <div class="main-menu-form-button">
                <input class="btn btn-block btn-primary" id="register-button"
                  name="submit-button" type="submit" value="register"
                  ng-disabled="disabled" />
              </div>
            </div>
          </div>
        </form>
      {% endif %}

    </div>
  </div>
</nav>

<!-- Modal page if user inserted unmatched password. -->
<div class="fade modal" id="wrong-password-modal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal" type="button">&times;</button>
        <h4 class="modal-title">error!</h4>
      </div>
      <div class="modal-body">
        wrong username and password combination
      </div>
    </div>

  </div>
</div>